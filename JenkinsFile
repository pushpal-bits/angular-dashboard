node {
  stageEnvCheck()

  stage('Build') {
    sh 'npm install'
    sh 'npm run-script build'
  } 
  
  stage('Test') {
    sh 'npm run-script lint' 
  }   
  stage('Deploy') {
    if("${env.ENV_DEPLOY}" == "Dev") {
    echo "Deploying to Development" 
    }
    if("${env.ENV_DEPLOY}" == "Staging") {
    echo "Deploying to Staging" 
    }
    if("${env.ENV_DEPLOY}" == "Prod") {
    echo "Deploying to Prod" 
    }
  }  



}

def stageEnvCheck() {
  def ENV_DEPLOY
  stage("User Input"){
    timeout(5){
      def ENV_PARAM = input message: 'Deployment Hardstop check', ok: 'Proceed', parameters: [
        choice(name: 'ENV', choices: ['Dev','Staging', 'Prod'].join('\n'), description: 'Select appropriate environment"')
      ]
      ENV_DEPLOY = "${ENV_PARAM}"
    }
  }
  return ENV_DEPLOY
}

